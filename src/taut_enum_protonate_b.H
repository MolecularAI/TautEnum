//
// file taut_enum_protonate_b.smk
// David Cosgrove
// AstraZeneca
// 24th December 2013
//
// Contains the default SMIRKS definitions for applying the ionisation/tautomer model.
// Developed by me from Pete Kenny's original leatherface rules.

#ifndef TAUT_ENUM_PROTONATE_B_SMK
#define TAUT_ENUM_PROTONATE_B_SMK

#include <string>

namespace DACLIB {

static const std::string PROTONATE_B = "\n\
########################################################################\n\
# made into SMIRKS by Dave Cosgrove December 2013\n\
########################################################################\n\
#\n\
#  set_prot_b.smt_v1.2                                PW Kenny 15-Aug-2005\n\
#\n\
#  SBDE Second step ionisation and tautomerisation SMARTS   Version 1.2\n\
#  Use with set_prot.vb_v1.1\n\
#\n\
#  These SMARTS were generated by making sbde_standardise.smt_v1.1\n\
#  SMARTS compatible with both Daylight and OEChem which differ in \n\
#  their use of the R and r descriptors.  \n\
#\n\
########################################################################\n\
#\n\
#  Protonation states are set in two steps.  These molecular \n\
#  edit directives control the second of of these in which \n\
#  tautomers & protonation states are enumerated for equilibria \n\
#  where both forms are likely to be relevant for example, \n\
#  'degenerate' tautomers like pyrazole and acids/bases with \n\
#  pKa close to physiological pH.  \n\
#\n\
#  For reasons of convenience, enumeration of tautomeric forms\n\
#  is typically, but not exclusively, carried out before \n\
#  enumeration of ionisation states.\n\
#\n\
#------------------------------------------------------------------\n\
#  Imidazoles & basic benzimidazoles\n\
#\n\
#  Special case:  If tautomers are flipped prior to protonation\n\
#  both canonical forms of cation will be generated.\n\
#\n\
#[$Imdz]\n\
#Prt 1  1\n\
[$Imdz:1]>>[*+:1][H] PROT_B_1\n\
#\n\
#-------------------------------------------------------------------\n\
#  Classical degenerate tautomers...\'degenerate\' denotes \n\
#  equivalence of energy rather than whips, neoprene & duck tape\n\
#\n\
#  Start with pyrazoles and 1,2,4-triazoles...note the use of \n\
#  the $c4 [in 2 aromatic rings] atom type to prevent conversion \n\
#  of indazoles to their quinoid forms\n\
#\n\
#\n\
#[nH]1[nX2][$c3;$c4][$c3&$c4,n&X2][$c3;$c4]1\n\
#Hyd  1  -1\n\
#Hyd  2   1\n\
[H][nH:1]1[nX2:2][$c3;$c4:3][$c3&$c4,n&X2:4][$c3;$c4:5]1>>[*:1]1[*:2]([H])[*:3][*:4][*:5]1 PROT_B_2\n\
#\n\
#    Flip imidazoles &  1,2,3-triazoles\n\
#\n\
#[nH]1[n&X2,$c3&$c4][nX2][$c3;$c4][$c3;$c4]1\n\
#Hyd  1  -1\n\
#Hyd  3   1\n\
[H][nH:1]1[n&X2,$c3&$c4:2][nX2:3][$c3;$c4:4][$c3;$c4:5]1>>[*:1]1[*:2][*:3]([H])[*:4][*:5]1 PROT_B_3\n\
#\n\
#    Fused analogues of imidazole & 1,2,3-triazole can all be \n\
#    flipped without worrying about quinoid forms.  However\n\
#    we need to check that flipping will not lead to increased\n\
#    electrostatic repulsion.\n\
#\n\
#[$NoHB][a;$R2]1[nX2][$c3,n&X2][nH][a;$R2]1[$NoHB]\n\
#Hyd  3   1\n\
#Hyd  5  -1\n\
[$NoHB:1][a;$R2:2]1[nX2:3][$c3,n&X2:4][nH:5]([H])[a;$R2:6]1[$NoHB:7]>>[*:1][*:2]1[*:3]([H])[*:4][*:5][*:6]1[*:7] PROT_B_4\n\
#\n\
#[$Acc][a;$R2]1[nX2][$c3,n&X2][nH][a;$R2]1[$Acc]\n\
#Hyd  3   1\n\
#Hyd  5  -1\n\
[$Acc:1][a;$R2:2]1[nX2:3][$c3,n&X2:4][nH:5]([H])[a;$R2:6]1[$Acc:7]>>[*:1][*:2]1[*:3]([H])[*:4][*:5][*:6]1[*:7] PROT_B_5\n\
#\n\
#[$Don][a;$R2]1[nX2][$c3,n&X2][nH][a;$R2]1[$Don]\n\
#Hyd  3   1\n\
#Hyd  5  -1\n\
[$Don:1][a;$R2:2]1[nX2:3][$c3,n&X2:4][nH:5]([H])[a;$R2:6]1[$Don:7]>>[*:1][*:2]1[*:3]([H])[*:4][*:5][*:6]1[*:7] PROT_B_6\n\
#\n\
#      1,2,3-Triazoles need additional flip moving H from\n\
#      N1 to N2 and this should not be done for ring-fused \n\
#      analogues otherwise get yucky o-quinoid form.  Note that\n\
#      this gets done after the N1 to N3 flip above!  \n\
#\n\
#[nH]1[nX2][nX2][$c3;$c4][$c3;$c4]1\n\
#Hyd  1  -1\n\
#Hyd  2   1\n\
[H][nH:1]1[nX2:2][nX2:3][$c3;$c4:4][$c3;$c4:5]1>>[*:1]1[*:2]([H])[*:3][*:4][*:5]1 PROT_B_7\n\
#\n\
#      Pyrimidones \n\
#\n\
#      4-Pyrimidiones\n\
#[O,S&X1]=c1[nH][$c3][nX2][$c3;$c4][$c3;$c4]1\n\
#Hyd  3  -1\n\
#Hyd  5   1\n\
[O,S&X1:1]=[c:2]1[nH:3]([H])[$c3:4][nX2:5][$c3;$c4:6][$c3;$c4:7]1>>[*:1]=[*:2]1[*:3][*:4][*:5]([H])[*:6][*:7]1 PROT_B_8\n\
#\n\
#      2-Pyrimidones\n\
#[nH]1c(=[O,S&X1])[nX2][$c3;$c4][$c3;$c4][$c3;$c4]1\n\
#Hyd  1  -1\n\
#Hyd  4   1\n\
[H][nH:1]1[c:2](=[O,S&X1:3])[nX2:4][$c3;$c4:5][$c3;$c4:6][$c3;$c4:7]1>>[*:1]1[*:2](=[*:3])[*:4]([H])[*:5][*:6][*:7]1 PROT_B_9\n\
#\n\
#----------------------------------------------------------------     \n\
#\n\
#  Enumerate protonation states for bases with pKa likely to \n\
#  be close to physiological pH.\n\
#\n\
#\n\
#  Aliphatic amines can be generally assumed to be cationic\n\
#  at physiological pH. Some exceptions to this rule have\n\
#  been defined in the vector binding file and we do this\n\
#  before flipping piperazines to avoid M371583 problem.\n\
#\n\
#[$Aminpka7]\n\
#Prt 1 -1\n\
[H][$Aminpka7:1]>>[*+0:1] PROT_B_10\n\
#\n\
#  Piperazines are only singly protonated in initial \n\
#  protonation step and so proton must be moved from\n\
#  one nitrogen to the other.  Note use of separate\n\
#  definitions for DABCO analogues and other cyclic\n\
#  diamines with ethylene between nitrogens\n\
#\n\
#[N;X4;+;H,H2]1CC[$Piperazn;!$N2Cat2]CC1\n\
#Prt 1 -1\n\
#Prt 4  1\n\
[H][N;X4;+;H,H2:1]1[C:2][C:3][$Piperazn;!$N2Cat2:4][C:5][C:6]1>>[*+0:1]1[*:2][*:3][*+:4]([H])[*:5][*:6]1 PROT_B_11\n\
#\n\
#[N;X4;+;H]1(C2)CC[$DABCOn;!$N2Cat2](C2)CC1\n\
#Prt 1 -1\n\
#Prt 5  1\n\
[H][N;X4;+;H:1]1([C:3]2)[C:4][C:5][$DABCOn;!$N2Cat2:2]([C:6]2)[C:7][C:8]1>>[*+0:1]1([C:3]2)[C:4][C:5][*+:2]([H])([C:6]2)[C:7][C:8]1 PROT_B_12\n\
#\n\
#[N;X4;+;H]-;@C-;@C-;@[$CycAm2n;!$N2Cat2]\n\
#Prt 1 -1\n\
#Prt 4  1\n\
[H][N;X4;+;H:1]-;@[C:2]-;@[C:3]-;@[$CycAm2n;!$N2Cat2:4]>>[*+0:1]-;@[C:2]-;@[C:3]-;@[*+:4][H] PROT_B_13\n\
#\n\
#  Ethylene diamines are first treated in a similar manner \n\
#  to piperazines but also need to allow dication so\n\
#  enumerate this as well\n\
#\n\
#[N;X4;+;H,H2,H3]CC[$AlipAmin;$N2CatAcy;!$N2Cat2]\n\
#Prt  1 -1\n\
#Prt  4  1\n\
[H][N;X4;+;H,H2,H3:1][C:2][C:3][$AlipAmin;$N2CatAcy;!$N2Cat2:4]>>[*+0:1][C:2][C:3][*+1:4][H] PROT_B_14\n\
#[N;X4;+;H,H2,H3]CC[$AlipAmin;$N2CatAcy;!$N2Cat2]\n\
#Prt  4  1\n\
[N;X4;+;H,H2,H3:1][C:2][C:3][$AlipAmin;$N2CatAcy;!$N2Cat2:4]>>[*:1][C:2][C:3][*+1:4][H] PROT_B_15\n\
#\n\
#   The (thankfully) rare N-Csp3-N systems\n\
#   First flip the proton\n\
#\n\
#[$AlipAmin][CX4][N;X4;!H0;+]\n\
#Prt 1  1\n\
#Prt 3 -1\n\
[H][$AlipAmin:1][CX4:2][N;X4;!H0;+:3]>>[H][*+:1][*:2][*+0:3] PROT_B_16\n\
#N[CX4][N;X4;!H0;+]\n\
#Prt 3 -1\n\
[N:1][CX4:2][N;X4;!H0;+:3][H]>>[N:1][*:2][*+0:3] PROT_B_17\n\
#\n\
#   Do the same for alkyl hydrazines\n\
#\n\
#[$am]-[N;X4;H;+]\n\
#Prt  1  1\n\
#Prt  2 -1\n\
[$am:1]-[N;X4;H;+:2][H]>>[H][*+:1]-[*+0:2] PROT_B_18\n\
#[$am]-[N;X4;H;+]\n\
#Prt  2 -1\n\
[$am:1]-[N;X4;H;+:2][H]>>[*:1]-[*+0:2] PROT_B_19\n\
#\n\
#  Heteroaromatic & other sp2 nitrogen likely to have pKa \n\
#  close to physiological pH have been defined in the \n\
#  vector binding file\n\
#\n\
#\n\
#[$Rng6Enum,$DiazInden,$TriazInden]\n\
#Prt  1  1\n\
[$Rng6Enum,$DiazInden,$TriazInden:1]>>[*+:1][H] PROT_B_20\n\
#[$GuanPrt3,$GuanPrt4,$FamdPrt3,$FamdPrt4]\n\
#Prt  1  1\n\
[$GuanPrt3,$GuanPrt4,$FamdPrt3,$FamdPrt4:1]>>[*+:1][H] PROT_B_21\n\
#\n\
#-----------------------------------------------------------------\n\
#\n\
#  Nitrogen acids\n\
#\n\
#  Moderately acidic sulfonamides\n\
#[$Sulfam2,$Sulfam3]\n\
#Prt  1  -1\n\
[H][$Sulfam2,$Sulfam3:1]>>[*-:1] PROT_B_22\n\
#\n\
#  TZDs\n\
#\n\
#[NH]1C(=O)[$([CX4]),$(C=C)][SX2]C1=O\n\
#Prt  1  -1\n\
[H][NH:1]1[C:4](=[O:5])[$([CX4]),$(C=C):2][SX2:3][C:6]1=[O:7]>>[*-:1]1[C:4](=[O:5])[*:2][*:3][C:6]1=[O:7] PROT_B_23\n\
#\n\
#  Benzotriazoles & ring-fused analogs\n\
#\n\
#[nH]1nnc2c1aaaa2\n\
#Prt  1  -1\n\
[H][$([nH]1nnc2c1aaaa2):1]>>[*-:1] PROT_B_24\n\
#\n\
#  Pyrazolones, isothiazolones & ring-fused analogues\n\
#\n\
#[O,S;X1]=c1[nH][n&X3,s&X2][$c3][$c3]1\n\
#Prt  3  -1\n\
[H][$([nH](c1=[O,S;X1])[n&X3,s&X2][$c3][$c3]1):1]>>[*-:1] PROT_B_25\n\
#[O,S;X1]=c1[n&X3,s&X2][nH][$c3][$c3]1\n\
#Prt  4  -1\n\
[H][$([nH]([n&X3,s&X2]c1=[O,S;X1])[$c3][$c3]1):1]>>[*-:1] PROT_B_26\n\
#\n\
#  Oxa-3,4-diazolones & analogues: pKa-DB lists values ranging \n\
#  from 7.25 to 7.70 for bland oxa-3,4-diazolones M009771, \n\
#  M156080 & M198586 although value for of 6.45 for M020876\n\
#  shows that an electron withdrawing substituent [4-pyridyl]\n\
#  can exert significant effects\n\
#\n\
#[nH]1[nX2][$c3][o,s]c1=O\n\
#Prt  1  -1\n\
[H][$([nH]1[nX2][$c3][o,s]c1=O):1]>>[*-:1] PROT_B_27\n\
#\n\
#  Oxa-2,4-diazolones & analogues.  These are converted into\n\
#  appropriate tautomer in primary standardisation step\n\
#\n\
#O=c1[nH][$c3][nX2][o,s]1\n\
#Prt  3  -1\n\
[H][$([nH](c1=O)[$c3][nX2][o,s]1):1]>>[*-:1] PROT_B_28\n\
#\n\
#  1,2,4-Triaz-thiones\n\
#\n\
#S=c1[nH][nX2][$c3][nH]1\n\
#Prt  3  -1\n\
[H][$([nH](c1=S)[nX2][$c3][nH]1):1]>>[*-:1] PROT_B_29\n\
#\n\
#  1,2,4-Benzothiadiazines & analogues [eg M014337]\n\
#  Analogue with Cl in benzo ring has pKa of 8.6 but \n\
#  aza-substitution shown [Tet 1995, v51, p3221] to\n\
#  lower this into more interesting range\n\
#\n\
#[NX2]1=C[NH][$c3,C&X3]~[$c3,C&X3]S1(=O)=O\n\
#Prt  3  -1\n\
[NX2:1]1=[C:2][NH:3]([H])[$c3,C&X3:4]~[$c3,C&X3:5]S1(=O)=O>>[*:1]1=[C:2][*-:3][*:4]~[*:5]S1(=O)=O PROT_B_30\n\
#  \n\
#  5,5-Disubstituted barbiturates\n\
#\n\
#[NH]1C(=O)[N;X3;!-]C(=O)[CD4]C1=O\n\
#Prt  1  -1\n\
[H][$([NH]1C(=O)[N;X3;!-]C(=O)[CD4]C1=O):1]>>[*-:1] PROT_B_31\n\
#\n\
#  Sulfonyl pyrazoles: Educated guess from triazoles & imidazole\n\
#  in Pest. Sci. 1990, v29, p227\n\
#\n\
#O=S(=O)c1[nH][nX2][c;!$c3][c;!$c3]1\n\
#Prt  5  -1\n\
[H][$([nH](c1S(=O)=O)[nX2][c;!$c3][c;!$c3]1):1]>>[*-:1] PROT_B_32\n\
#\n\
#-----------------------------------------------------------------\n\
#\n\
#  Moderately acidic hydroxyl\n\
#\n\
#  Second ionisation of phosph(on)ate\n\
#\n\
#[OH]P(=O)([O-])[A,a;!-]\n\
#Prt  1  -1\n\
[H][$([OH]P(=O)([O-])[A,a;!-]):1]>>[*-:1] PROT_B_33\n\
#  \n\
#\n\
#  Phenols are generally neutral at physiological pH although\n\
#  suitably placed electron-withdrawing substitiuents can bring \n\
#  pKa down to 7 and in some rare cases significantly below this.\n\
#\n\
#[$PhOHenum]\n\
#Prt  1  -1\n\
[H][$PhOHenum:1]>>[*-:1] PROT_B_34\n\
#\n\
#  Hydroxamic acids\n\
#\n\
#[OH]NC(=O)\n\
#Prt 1  -1\n\
[H][$([OH]NC(=O)):1]>>[*-:1] PROT_B_35\n\
#\n\
# N-hydroxyimidazoles: JMC 2002, v45, p19 suggests pKa ~8.8\n\
#\n\
#[OH]n1[$c3][nX2][$c3][$c3]1\n\
#Prt 1  -1\n\
[H][$([OH]n1[$c3][nX2][$c3][$c3]1):1]>>[*-:1] PROT_B_36\n\
#\n\
# Pyridone carboxylic acids [these will have already been ionised]\n\
#\n\
#[O-]C(=O)c1c(=O)cc[nX3]c1\n\
#Prt 1   1\n\
[$([O-]C(=O)c1c(=O)cc[nX3]c1):1]>>[*+0:1][H] PROT_B_37\n\
#\n\
#  6-Hydroxypyrid-2-ones\n\
#\n\
#[OH]c1[nX3]c(=O)ccc1\n\
#Prt 1  -1\n\
[H][$([OH]c1[nX3]c(=O)ccc1):1]>>[*-:1] PROT_B_38\n\
#\n\
#-------------------------------------------------------------------\n\
#\n\
#  Aromatic (including heteroaromatic) thiols\n\
#[S;X2;H]c\n\
#Prt  1 -1\n\
[H][$([S;X2;H]c):1]>>[*-:1] PROT_B_39\n\
#\n\
#-------------------------------------------------------------------";

}

#endif // TAUT_ENUM_PROTONATE_B_SMK
